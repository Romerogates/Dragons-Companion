<div class="step-container">
  <div class="step-header">
    <h2>RÃ©partissez vos caractÃ©ristiques</h2>
    <p class="step-description">
      Vous avez <strong>{{ creationService.character().pointsRemaining }} points</strong> Ã  rÃ©partir
      pour dÃ©finir vos attributs. Les bonus raciaux s'ajoutent automatiquement au total.
    </p>
  </div>

  <div class="points-panel" [class.warning]="creationService.character().pointsRemaining < 0">
    <span class="points-label">Points restants</span>
    <span class="points-value">{{ creationService.character().pointsRemaining }}</span>
  </div>

  <div class="abilities-grid">
    @for (ability of abilities; track ability) {
    <div class="ability-card">
      <div class="ability-header">
        <div class="ability-title">
          <span class="ability-icon">{{ getAbilityIcon(ability) }}</span>
          <span class="ability-name">{{ abilityNames[ability] }}</span>
        </div>
        <div class="ability-modifier" [class.positive]="getModifierValue(ability) > 0">
          {{ getModifier(ability) }}
        </div>
      </div>

      <div class="ability-controls">
        <button
          class="control-btn decrement"
          [disabled]="!canDecrement(ability)"
          (click)="decrement(ability)"
          aria-label="Diminuer"
        >
          âˆ’
        </button>

        <div class="ability-values">
          <div class="value-row">
            <span class="base-value" title="Valeur de base">{{ getBaseValue(ability) }}</span>
            @if (getRacialBonus(ability) !== 0) {
            <span class="racial-bonus" title="Bonus racial">+{{ getRacialBonus(ability) }}</span>
            }
          </div>
          <span class="final-value">Total: {{ getFinalValue(ability) }}</span>
        </div>

        <button
          class="control-btn increment"
          [disabled]="!canIncrement(ability)"
          (click)="increment(ability)"
          aria-label="Augmenter"
        >
          +
        </button>
      </div>

      <div class="ability-cost">CoÃ»t actuel : {{ getPointCost(getBaseValue(ability)) }} pts</div>
    </div>
    }
  </div>

  <div class="actions">
    <button class="reset-btn" (click)="reset()">ðŸ”„ RÃ©initialiser les points</button>
  </div>

  <div class="cost-table">
    <h4>ðŸ“Š CoÃ»t des caractÃ©ristiques</h4>
    <div class="cost-grid">
      @for (entry of [8, 9, 10, 11, 12, 13, 14, 15]; track entry) {
      <div class="cost-entry" [class.active]="hasBaseValue(entry)">
        <span class="cost-score">{{ entry }}</span>
        <span class="cost-points">{{ getPointCost(entry) }} pts</span>
      </div>
      }
    </div>
  </div>
</div>
